{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/kedro-inputs/","result":{"data":{"markdownRemark":{"id":"d3ae8134-abbf-50fd-8974-0ad32dac89eb","html":"<p>Passing inputs into kedro is a key concept.  Understanding how it accepts a single catalog key as input is quite trivial that easily makes sense, but passing a list or dictionary of catalog entries can be a bit confusing.</p>\n<h2>*args/**args review</h2>\n<p>Check out this post for a review of how <code class=\"language-text\">*args</code> <code class=\"language-text\">**kwargs</code> work in python.</p>\n<p><a href=\"https://waylonwalker.com/blog/python-args-kwargs\"><img src=\"https://waylonwalker.com/python-args-kwargs.png\" alt=\"python args and kwargs\"></a></p>\n<blockquote>\n<p><a href=\"https://waylonwalker.com/blog/python-args-kwargs\">python args and kwargs</a> article by <a href=\"https://twitter.com/_WaylonWalker\">@_waylonwalker</a></p>\n</blockquote>\n<h2>All Kedro inputs are catalog Entries</h2>\n<p>When kedro runs your pipeline it uses the catalog to imperatively load your data, meaning that you don't tell kedro how to load your data, you tell it where your data is and what type it is.  These catalog entries are like a <code class=\"language-text\">key-value</code> store.  You just need to give the key when setting up a node.</p>\n<h2>Single Inputs</h2>\n<p>These are fairly straightforward to understand.  In the example below when <code class=\"language-text\">kedro</code> runs the pipeline it will load the input from the catalog, then pass that input to the func, then save the returned value to the output catalog entry.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>pipeline <span class=\"token keyword\">import</span> node\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">create_int_sales</span><span class=\"token punctuation\">(</span>sales<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">\"cleans up raw sales data\"</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token keyword\">return</span> cleaned_sales\n\nmy_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">(</span>\n    func<span class=\"token operator\">=</span>create_int_sales<span class=\"token punctuation\">,</span>\n    inputs<span class=\"token operator\">=</span><span class=\"token string\">'raw_sales'</span><span class=\"token punctuation\">,</span>\n    output<span class=\"token operator\">=</span><span class=\"token string\">'int_sales'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<hr>\n<h2>List of inputs</h2>\n<p>Let's look at an example node that combines more than one dataset. When kedro has sees a list of catalog entries it will load up each catalog entry sequentially then pass them in order to the <code class=\"language-text\">create_sales_report</code> function.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>pipeline <span class=\"token keyword\">import</span> node\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">create_sales_report</span><span class=\"token punctuation\">(</span>sales<span class=\"token punctuation\">,</span> products<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">\"adds product metadata to the sales data\"</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n\nmy_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">(</span>\n    func<span class=\"token operator\">=</span>create_sales_report<span class=\"token punctuation\">,</span>\n    inputs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'pri_sales'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pri_products'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    output<span class=\"token operator\">=</span><span class=\"token string\">'sales_report'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<h2>simulating pipeline run using 2 inputs</h2>\n<p>Here We can simulate what kedro does during the pipeline run by using <code class=\"language-text\">*args</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># inputs you gave kedro</span>\ninputs<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'pri_sales'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'pri_products'</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># load data</span>\ninput_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>catalog<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> entry <span class=\"token keyword\">in</span>  inputs<span class=\"token punctuation\">]</span>\n<span class=\"token comment\"># run the node</span>\nsales_report <span class=\"token operator\">=</span> create_sales_report<span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>input_data<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># save the data to the output</span>\ncatalog<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>sales_report<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>sales_report<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>More generalizable functions</h2>\n<p>We can also use <code class=\"language-text\">*args</code> to make our functions a little bit more generalizable. The first that\ncomes to my mind is a unioner. The second</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">def</span> <span class=\"token function\">unioner</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span>dfs<span class=\"token punctuation\">:</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> pd<span class=\"token punctuation\">.</span>DataFrame\n    pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span>dfs<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now we can pass any number of DataFrames into our kedro node to get unioned together, but\ndo we really need a function for a one-liner... No we can use an inline function for this case.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">my_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">(</span>\n    func<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> <span class=\"token operator\">*</span>dfs<span class=\"token punctuation\">:</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span>dfs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token builtin\">input</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'sales_2017'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'sales_2018'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    output<span class=\"token operator\">=</span><span class=\"token string\">'sales'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2><code class=\"language-text\">*args</code> scares the crap out of me!</h2>\n<p>It's great for the <code class=\"language-text\">unioner</code> example where its a collection of similar things where order\ndoes not matter.  But for the <code class=\"language-text\">create_sales_report</code> function.  Those are distinctly different\ninputs.  If someone does some refactoring and changes the order in one place or another it's\ngoing to turn into a bad day real fast.</p>\n<h2>**kwargs are a bit better</h2>\n<p>Let's refactor the <code class=\"language-text\">create_sales_report</code> before someone tries to ruin our day.  We can easily\ndo this by passing a dictionary (keys are the argument name, values are the catalog key)\nof arguments to kedro instead of a list.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> kedro<span class=\"token punctuation\">.</span>pipeline <span class=\"token keyword\">import</span> node\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">create_sales_report</span><span class=\"token punctuation\">(</span>sales<span class=\"token punctuation\">,</span> products<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">\"adds product metadata to the sales data\"</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nmy_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">(</span>\n    func<span class=\"token operator\">=</span>create_sales_report<span class=\"token punctuation\">,</span>\n    inputs<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'sales'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'pri_sales'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'products'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'pri_products'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    output<span class=\"token operator\">=</span><span class=\"token string\">'sales_report'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span></code></pre></div>\n<p>Now if someone tries to refactor the order of arguments we are safe!</p>\n<h2>Simulating the pipeline run with <code class=\"language-text\">**kwargs</code></h2>\n<p>Pretty much the same as before, except with <code class=\"language-text\">**kwargs</code> and <code class=\"language-text\">dictionaries</code> keeping us a bit\nsafer.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># inputs you gave kedro</span>\ninputs<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'sales'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'pri_sales'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'products'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'pri_products'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\"># load data</span>\ninput_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>arg<span class=\"token punctuation\">:</span> catalog<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>entry<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> arg<span class=\"token punctuation\">,</span> entry <span class=\"token keyword\">in</span> inputs<span class=\"token punctuation\">.</span>items<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\"># run the node</span>\nsales_report <span class=\"token operator\">=</span> create_sales_report<span class=\"token punctuation\">(</span><span class=\"token operator\">**</span>input_data<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># save the data to the output</span>\ncatalog<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>sales_report<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>sales_report<span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Stay Safe</h2>\n<p>Kedro inputs are quite easy to understand if you already have a grasp of <code class=\"language-text\">*args</code> and <code class=\"language-text\">**kwargs</code>\nand if you don't it is still fairly intuitive to pick up.  Stay on the safe side, if your\ncollection of inputs are clearly different things, use a dictionary for safety.</p>","fields":{"slug":"/blog/kedro-inputs/"},"frontmatter":{"date":"2020-06-19T03:00:00.000Z","devto_url":"","devto_id":"","title":"How Kedro handles your inputs","description":"Passing inputs into kedro is a key concept. Understanding how it accepts a single catalog key as input is quite trivial that easily makes sense, but passing a list or dictionary of catalog entries can be a bit confusing.","path":"kedro-inputs","twitter_cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/kedro-inputs.png","childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB40lEQVQY02MQV9RX1TV9//JSfGq+T3Csq2+4uYN3R+8UUztPTSN7BXUzJXULHV17HV07XT0bIxMHY1MHAyMbI1MbAyMLBlEFXW0Tu9OnjtQ0de7ac2Dx8jUbNm+/dftuXXPXhYtX4uPyxWR0tfXs9fSByFZP30bf0FrPwErP0FLP0JxBUklfXsNUw9DB0snXOyzO0Ts0PqswvaRS0cBqysz5Fk6+PDJqBvpOytoW6jqW+vq2uvqWYGSmZ2DGIKlsANQvqqAjr2ikoWguLaunq2jlrOnhoustKKkRaBA037ttokd9t3tVnHWMnLaRgb6tjoG5jrE9UD9Is6yKEaecap1j4e3YdZPd6/YGz9obMutm9GpbPfdZns0rfXrirOIqnPL2h8zyMvPX0NbW05K1tjawsTaHamaVUe52qTwfsfRE2KLXSbvL7bLneXe0OJcV2+VkW6VkWKdUOxV8Sz2c75SpoCYpLSmhpy5hbmYC0iytbMglp5ZrndbnWl3rUHApYpmDnoervs/WgClWOq7ehgFu+j6Zlsl1TgXaetYaWsYiwkIy8mrSKkYMEkr6kkoG4kr6sspGMspG4kp6SqqmCqomQgo6wgrawkBSUUdEUYdbTg1ogZyqkbKmmaSijriiHlAjAH2nh1iwmWC+AAAAAElFTkSuQmCC","width":800,"height":418,"src":"/static/e1d944a85e955e03bd0085102a3de15d/267c5/kedro-inputs.png","srcSet":"/static/e1d944a85e955e03bd0085102a3de15d/267c5/kedro-inputs.png 1x"}}},"cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/kedro-inputs.png","childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB40lEQVQY02MQV9RX1TV9//JSfGq+T3Csq2+4uYN3R+8UUztPTSN7BXUzJXULHV17HV07XT0bIxMHY1MHAyMbI1MbAyMLBlEFXW0Tu9OnjtQ0de7ac2Dx8jUbNm+/dftuXXPXhYtX4uPyxWR0tfXs9fSByFZP30bf0FrPwErP0FLP0JxBUklfXsNUw9DB0snXOyzO0Ts0PqswvaRS0cBqysz5Fk6+PDJqBvpOytoW6jqW+vq2uvqWYGSmZ2DGIKlsANQvqqAjr2ikoWguLaunq2jlrOnhoustKKkRaBA037ttokd9t3tVnHWMnLaRgb6tjoG5jrE9UD9Is6yKEaecap1j4e3YdZPd6/YGz9obMutm9GpbPfdZns0rfXrirOIqnPL2h8zyMvPX0NbW05K1tjawsTaHamaVUe52qTwfsfRE2KLXSbvL7bLneXe0OJcV2+VkW6VkWKdUOxV8Sz2c75SpoCYpLSmhpy5hbmYC0iytbMglp5ZrndbnWl3rUHApYpmDnoervs/WgClWOq7ehgFu+j6Zlsl1TgXaetYaWsYiwkIy8mrSKkYMEkr6kkoG4kr6sspGMspG4kp6SqqmCqomQgo6wgrawkBSUUdEUYdbTg1ogZyqkbKmmaSijriiHlAjAH2nh1iwmWC+AAAAAElFTkSuQmCC","width":1000,"height":420,"src":"/static/e1d944a85e955e03bd0085102a3de15d/a8734/kedro-inputs.png","srcSet":"/static/e1d944a85e955e03bd0085102a3de15d/a8734/kedro-inputs.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB40lEQVQY02MQV9RX1TV9//JSfGq+T3Csq2+4uYN3R+8UUztPTSN7BXUzJXULHV17HV07XT0bIxMHY1MHAyMbI1MbAyMLBlEFXW0Tu9OnjtQ0de7ac2Dx8jUbNm+/dftuXXPXhYtX4uPyxWR0tfXs9fSByFZP30bf0FrPwErP0FLP0JxBUklfXsNUw9DB0snXOyzO0Ts0PqswvaRS0cBqysz5Fk6+PDJqBvpOytoW6jqW+vq2uvqWYGSmZ2DGIKlsANQvqqAjr2ikoWguLaunq2jlrOnhoustKKkRaBA037ttokd9t3tVnHWMnLaRgb6tjoG5jrE9UD9Is6yKEaecap1j4e3YdZPd6/YGz9obMutm9GpbPfdZns0rfXrirOIqnPL2h8zyMvPX0NbW05K1tjawsTaHamaVUe52qTwfsfRE2KLXSbvL7bLneXe0OJcV2+VkW6VkWKdUOxV8Sz2c75SpoCYpLSmhpy5hbmYC0iytbMglp5ZrndbnWl3rUHApYpmDnoervs/WgClWOq7ehgFu+j6Zlsl1TgXaetYaWsYiwkIy8mrSKkYMEkr6kkoG4kr6sspGMspG4kp6SqqmCqomQgo6wgrawkBSUUdEUYdbTg1ogZyqkbKmmaSijriiHlAjAH2nh1iwmWC+AAAAAElFTkSuQmCC","aspectRatio":2.380952380952381,"src":"/static/e1d944a85e955e03bd0085102a3de15d/a8734/kedro-inputs.png","srcSet":"/static/e1d944a85e955e03bd0085102a3de15d/2d6f8/kedro-inputs.png 250w,\n/static/e1d944a85e955e03bd0085102a3de15d/03ac3/kedro-inputs.png 500w,\n/static/e1d944a85e955e03bd0085102a3de15d/a8734/kedro-inputs.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"d3ae8134-abbf-50fd-8974-0ad32dac89eb"}}}