{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/3-things-to-automate-with-python/","result":{"data":{"markdownRemark":{"id":"28e03f3f-2494-5b1f-be4e-1592a12dfb82","html":"<p>Here are three things that I see my non programming counterparts doing every single day.  These really sum up so much of what folks do within an office.  So many of us dabble in or become power users of spreadsheets without knowing there is an alternative out there that can save us time, automate boring things, and allow us to open up our minds for the part that we add value, Thinking about the data.  Lets face it, stitching together spreadsheets is zero value add by itself, but if you can see something in the data and take action on it, this can be huge value add to your company.</p>\n<h2>Merge a directory full of spreadsheets into one</h2>\n<p>I see this one all the time.  One team gets a spreadsheet from another team once per month and they need to stich all the pieces together.  Excel really opens the door for some nasty hidden bugs in your manually stiched together data.  It also takes time out of your day that you dont need to spend.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">from</span> pathlib <span class=\"token keyword\">import</span> Path\n\ncsvs <span class=\"token operator\">=</span> Path<span class=\"token punctuation\">.</span>glob<span class=\"token punctuation\">(</span><span class=\"token string\">'raw/*.csv'</span><span class=\"token punctuation\">)</span>\ncsvs_combined <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>concat<span class=\"token punctuation\">(</span>csvs<span class=\"token punctuation\">)</span>\ncsvs_combined<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'processed/combined.csv'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Fetch data from a url</h2>\n<p>It might be possible that the other team shares their data on a website.  If you can get access to the data via a url, as in the example below there is no need to go to the website to save the data every week/month, you can have python do that for you.  It's very likely that you will need to combine this with step one in many workflows.  Now your data compiling can be done in one single running of a script.  Your data is still in a format that excel can read and you can stick with a hybrid workflow while you become comfortable in python.</p>\n<p>There is no shame in opening excel to do something in 5 minutes that would take an hour of research to do in python.  If you stick to it though, piece by piece everything will come together.  You will be able to do more in python than you could imagine in excel and you will wonder how you did it without the help of python.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\ncars_url <span class=\"token operator\">=</span> <span class=\"token string\">'https://www.kaggle.com/abineshkumark/carsdata/download/xrvGk4JtQZJZetxwsCCy%2Fversions%2Fl2HR9tTLKz8MzHMAjBcl%2Ffiles%2Fcars.csv?datasetVersionNumber=1'</span>\ncars <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_csv<span class=\"token punctuation\">(</span>cars_url<span class=\"token punctuation\">)</span>\n\ncars<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'cars.csv'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h2>Fetch data from a database</h2>\n<p>This one can be a bit trickier, often requires hunting down tables that are undocumented. Getting access, and figuring out the crednetials.  If you can get over that hump though it is likely that you will have access to several data source that you typically use in one place.  From there you can learn how to join them together to create powerful workflows.</p>\n<p>SQL can be a very daunting language to learn but if you spend an hour with it you will know enough to at least get the data into python or excel.  You can continue to hone your sql skills and move more of your aggregation/analysis into the database for better performance.  If you are asking for 1M rows for a 10 row report the efficiency gains of doing that aggregation in the database and not sending 1M rows over the wire can be immense.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">from</span> sqlalchemy <span class=\"token keyword\">import</span> create engine\n\nengine <span class=\"token operator\">=</span> create_engine<span class=\"token punctuation\">(</span><span class=\"token string\">'postgresql://scott:tiger@localhost:5432/mydatabase'</span><span class=\"token punctuation\">)</span>\n\nsql <span class=\"token operator\">=</span> <span class=\"token string\">'select * from inventory'</span>\n\n<span class=\"token keyword\">with</span> engine<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> connection<span class=\"token punctuation\">:</span>\n    inventory <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_sql<span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">,</span> con<span class=\"token punctuation\">)</span>\nengine<span class=\"token punctuation\">.</span>dispose<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\ninventory<span class=\"token punctuation\">.</span>to_csv<span class=\"token punctuation\">(</span><span class=\"token string\">'cars'</span><span class=\"token punctuation\">)</span></code></pre></div>","fields":{"slug":"/blog/3-things-to-automate-with-python/"},"frontmatter":{"date":"2020-06-01T05:00:00.000Z","devto_url":"","devto_id":"","title":"Three things to Automate with Python","description":"Here are three things that I see my non programming counterparts doing every single day.  These really sum up so much of what folks do within an office.","path":"3-things-to-automate-with-python","twitter_cover":null,"cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/3-things-to-automate-with-python.png","childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABu0lEQVQY02OQN3CR1bFVc0lUdUnQ88jw9qsQUTWWM/cXUtYXVtCWUDaUUjNW17FR17FS17FU1TXT0rPQM7DUNQCSZgzyBs5yBs4K+s5C2pYhphE3olZ7G/pLyGtFm0Z5GAa4GQf6GQd7mAR4mAbEWsek2yVaGzlr6VvoGVqCNEsqG0gq6Usr6fPKqXU6V1yJXHExatkK357VAZPORy07H7l0d/DM3SGzLketmOvT+iR+03TvBmUdQwN9U31Dc7BmIFIxkFI29DT09zcIzbfIjjeLs9fyDtOPDdCLcNH1D7OIyrVPD7YITbFLjLEM0zR11rDw09IxgWlWBmo24JTWMLMyTEsw8w/RM7LSC43Q9/TT17fQlVM3VdQyV9YwlVfXVzW0sUztKmsrCveDaZZQ0gcicUUDFW0DC2sjU3NjO3uT2HDz6FBTZydDOTUTU1M3F5cgH+9gRS2Xro6oS+tsnR3AfobohCBRBX0hWT1hOX1heX0eCR0pNavg6MywuPTAiKSs3PKMzCIdPStLMxNDY1MReQMGZJ3ISFJZX1JJT07dSMPIVlHbQkLZQEhGU1RWS0nDRFrFCGgHUA0AsKNzjtNOBtMAAAAASUVORK5CYII=","width":1000,"height":420,"src":"/static/707d15ebae9a7e149ca3ec1ad7b7f991/a8734/3-things-to-automate-with-python.png","srcSet":"/static/707d15ebae9a7e149ca3ec1ad7b7f991/a8734/3-things-to-automate-with-python.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABu0lEQVQY02OQN3CR1bFVc0lUdUnQ88jw9qsQUTWWM/cXUtYXVtCWUDaUUjNW17FR17FS17FU1TXT0rPQM7DUNQCSZgzyBs5yBs4K+s5C2pYhphE3olZ7G/pLyGtFm0Z5GAa4GQf6GQd7mAR4mAbEWsek2yVaGzlr6VvoGVqCNEsqG0gq6Usr6fPKqXU6V1yJXHExatkK357VAZPORy07H7l0d/DM3SGzLketmOvT+iR+03TvBmUdQwN9U31Dc7BmIFIxkFI29DT09zcIzbfIjjeLs9fyDtOPDdCLcNH1D7OIyrVPD7YITbFLjLEM0zR11rDw09IxgWlWBmo24JTWMLMyTEsw8w/RM7LSC43Q9/TT17fQlVM3VdQyV9YwlVfXVzW0sUztKmsrCveDaZZQ0gcicUUDFW0DC2sjU3NjO3uT2HDz6FBTZydDOTUTU1M3F5cgH+9gRS2Xro6oS+tsnR3AfobohCBRBX0hWT1hOX1heX0eCR0pNavg6MywuPTAiKSs3PKMzCIdPStLMxNDY1MReQMGZJ3ISFJZX1JJT07dSMPIVlHbQkLZQEhGU1RWS0nDRFrFCGgHUA0AsKNzjtNOBtMAAAAASUVORK5CYII=","aspectRatio":2.380952380952381,"src":"/static/707d15ebae9a7e149ca3ec1ad7b7f991/a8734/3-things-to-automate-with-python.png","srcSet":"/static/707d15ebae9a7e149ca3ec1ad7b7f991/2d6f8/3-things-to-automate-with-python.png 250w,\n/static/707d15ebae9a7e149ca3ec1ad7b7f991/03ac3/3-things-to-automate-with-python.png 500w,\n/static/707d15ebae9a7e149ca3ec1ad7b7f991/a8734/3-things-to-automate-with-python.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"28e03f3f-2494-5b1f-be4e-1592a12dfb82"}}}