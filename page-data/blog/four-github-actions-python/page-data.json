{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/four-github-actions-python/","result":{"data":{"markdownRemark":{"id":"a1c939c9-ce0b-5d1d-8c36-fdbcde7a7e20","html":"<style>\nh2 img { width: 100%; box-shadow: .5rem .5rem 3rem #141F2D, -.5rem -.5rem 3rem rgba(255,255,255,.1);}\nimg{ max-width: 100% !important;}\n</style>\n<p>If you are developing python packages and using GitHub here are four actions that you can use today to automate your release workflow.  Since python tools generally have such a simple cli I have opted to use the cli for most of these, that way I know exactly what is happening and have more control over it if I need.</p>\n<ul>\n<li>Lint</li>\n<li>Test</li>\n<li>Package</li>\n<li>Upload to PyPi</li>\n</ul>\n<h2><img src=\"https://waylonwalker.com/gh-actions-python-headers/1.png\" alt=\"Lint With flake8\"></h2>\n<p>flake8 is pythons quintessential linting tool to ensure that your code is up to the standards that you have set for the project, and to help prevent hidden bugs.  I am a heavy user of <code class=\"language-text\">black</code> and <code class=\"language-text\">isort</code> as well, but for ci flake8 is typically considered the gold standard. <code class=\"language-text\">black</code> and <code class=\"language-text\">isort</code> will help you automate many fixes suggested by flake8.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Lint with flake8\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        pip install flake8 isort black\n        # stop the build if there are Python syntax errors or undefined names\n        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics\n        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide\n        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics</span></code></pre></div>\n<h2><img src=\"https://waylonwalker.com/gh-actions-python-headers/2.png\" alt=\"Testing with pytest\"></h2>\n<p>pytest is such an amazing project, definitely one to check out and start using if you are not already doing so.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Test with pytest\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n         pip install pytest\n         pytest</span></code></pre></div>\n<h2><img src=\"https://waylonwalker.com/gh-actions-python-headers/3.png\" alt=\"Building with setuptools\"></h2>\n<p>I am still using the older, less hipster, setuptools to build my projects.  Primarily because I am used to to, partly because things such as editable installs are not possible with the newer build tools, and I am a <strong>HEAVY</strong> user of editable installs.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    - name: build\n      run: |\n        pip install wheel\n        python setup.py sdist bdist_wheel</code></pre></div>\n<h2><img src=\"https://waylonwalker.com/gh-actions-python-headers/4.png\" alt=\"Publishing to pypi\"></h2>\n<p>Here I am going to use an amazing action from the GitHub marketplace by @webKnjaZ.  It is super simple.  First you need to log into your <a href=\"pypi.org\">pypi.org</a> account, go to account settings, enable 2FA, and add a Token, then paste that toke into a secret inside your repos settings.  Next just drop the name of that secret into the password field of the action and you are off.</p>\n<p><strong>note</strong>: I did put a check in to make sure that push event comes from main.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> pypi<span class=\"token punctuation\">-</span>publish\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.ref == 'refs/heads/main'\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> pypa/gh<span class=\"token punctuation\">-</span>action<span class=\"token punctuation\">-</span>pypi<span class=\"token punctuation\">-</span>publish@v1.1.0\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># PyPI user</span>\n        <span class=\"token comment\"># Password for your PyPI user or an access token</span>\n        <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.pypi_password <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token comment\"># The repository URL to use</span>\n        <span class=\"token comment\"># repository_url: # optional</span>\n        <span class=\"token comment\"># The target directory for distribution</span>\n        <span class=\"token comment\"># packages_dir: # optional, default is dist</span></code></pre></div>\n<h2>That's my four top python actions</h2>\n<p>These are the easiest and most basic four actions that every python project on GitHub should have.  Now that actions are available for free on any public repo there is no reason not to use GitHub Actions for any new project.</p>","fields":{"slug":"/blog/four-github-actions-python/"},"frontmatter":{"date":"2020-04-13T06:23:00.000Z","devto_url":"","devto_id":"","title":"Four Github Actions for Python","description":"","path":"four-github-actions-python","twitter_cover":null,"cover":{"absolutePath":"/home/runner/work/waylonwalkerv2/waylonwalkerv2/static/four-github-actions-python.png","childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABw0lEQVQY0y2QXU/TUByH+w1MuDDrSt9Oz+lpT09fDu3a9Y2OTba5IRCEzUnMYEAQTQZZQoiiiIbEaPBKExMTb/wofho/hh2a/C6e/8XzXPw5gdQPD4rpybJMowWFCWa8aMYiSSWSyjRTaA6cArot6OS6myI7sloj9/jH1uvby7OCWwCss3M0e3t7efNlsPfiPgpEkogkFs26aESKnatOoZJEozG0E2S4sDn5+ev0z+/mt+uc441Qr60U/e3u9jhu7wgkEXC4iEN5aRUuP5FwCNwGzh4DM4BuZmTrktN6P0u+XqWAZpxop/dke224f/bmYzy52X1+joIHVTPWiqE9ukKNp9bmzH/5nfQO2cFnNvlkdfZF6Mskw17GVc2oSiKJxihs08GFP752dt/JfkeN+np7D3ePnOEra2Nqro5p/9hIH6F8gLpTg6V3Mg4EMvcruq/3T4ytc9AYCVYs0kRiK6C+hpJ1GbkKZqruAYNprKltfNB6F3Jtk6sAtwIZr/t8WaFpCRU0P6uQCdAToSfjJYWEKokArc/fRkM1f4YfnqKwdyf/m+r8B80rmdc8ATJR9yUjkLAvmzWF1OYJKyy7fDnN+wuIIWtMzi3uMwAAAABJRU5ErkJggg==","width":1000,"height":420,"src":"/static/ce09544f4bd8e937cdd8c276c02207d6/a8734/four-github-actions-python.png","srcSet":"/static/ce09544f4bd8e937cdd8c276c02207d6/a8734/four-github-actions-python.png 1x"},"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABw0lEQVQY0y2QXU/TUByH+w1MuDDrSt9Oz+lpT09fDu3a9Y2OTba5IRCEzUnMYEAQTQZZQoiiiIbEaPBKExMTb/wofho/hh2a/C6e/8XzXPw5gdQPD4rpybJMowWFCWa8aMYiSSWSyjRTaA6cArot6OS6myI7sloj9/jH1uvby7OCWwCss3M0e3t7efNlsPfiPgpEkogkFs26aESKnatOoZJEozG0E2S4sDn5+ev0z+/mt+uc441Qr60U/e3u9jhu7wgkEXC4iEN5aRUuP5FwCNwGzh4DM4BuZmTrktN6P0u+XqWAZpxop/dke224f/bmYzy52X1+joIHVTPWiqE9ukKNp9bmzH/5nfQO2cFnNvlkdfZF6Mskw17GVc2oSiKJxihs08GFP752dt/JfkeN+np7D3ePnOEra2Nqro5p/9hIH6F8gLpTg6V3Mg4EMvcruq/3T4ytc9AYCVYs0kRiK6C+hpJ1GbkKZqruAYNprKltfNB6F3Jtk6sAtwIZr/t8WaFpCRU0P6uQCdAToSfjJYWEKokArc/fRkM1f4YfnqKwdyf/m+r8B80rmdc8ATJR9yUjkLAvmzWF1OYJKyy7fDnN+wuIIWtMzi3uMwAAAABJRU5ErkJggg==","aspectRatio":2.380952380952381,"src":"/static/ce09544f4bd8e937cdd8c276c02207d6/a8734/four-github-actions-python.png","srcSet":"/static/ce09544f4bd8e937cdd8c276c02207d6/2d6f8/four-github-actions-python.png 250w,\n/static/ce09544f4bd8e937cdd8c276c02207d6/03ac3/four-github-actions-python.png 500w,\n/static/ce09544f4bd8e937cdd8c276c02207d6/a8734/four-github-actions-python.png 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}}}},"pageContext":{"id":"a1c939c9-ce0b-5d1d-8c36-fdbcde7a7e20"}}}